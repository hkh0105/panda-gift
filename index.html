<!DOCTYPE html>
<html lang="ko">
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no,maximum-scale=1"><title>ìƒì¼ì¶•í•˜í•´ ì§œê¸° ğŸ’•</title>
<meta property="og:title" content="ë³´ìœ¤ì•„, ìƒì¼ì¶•í•˜í•´ ì§œê¸° ğŸ’•">
<meta property="og:description" content="ìœ„í•´ ì¤€ë¹„í•œ íŠ¹ë³„í•œ ì„ ë¬¼ì´ ìˆì–´! ê²Œì„ì„ í´ë¦¬ì–´í•˜ë©´ ë¹„ë°€ì´ ë°í˜€ì ¸ ğŸ">
<meta property="og:image" content="https://panda-gift-kappa.vercel.app/og.jpeg">
<meta property="og:url" content="https://panda-gift-kappa.vercel.app">
<meta property="og:type" content="website">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:title" content="ë³´ìœ¤ì•„, ìƒì¼ì¶•í•˜í•´ ì§œê¸° ğŸ’•">
<meta name="twitter:description" content="ìœ„í•´ ì¤€ë¹„í•œ íŠ¹ë³„í•œ ì„ ë¬¼ì´ ìˆì–´! ê²Œì„ì„ í´ë¦¬ì–´í•˜ë©´ ë¹„ë°€ì´ ë°í˜€ì ¸ ğŸ">
<meta name="twitter:image" content="https://panda-gift-kappa.vercel.app/og.jpeg">
<style>
@import url('https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700&family=Quicksand:wght@400;600;700&display=swap');
:root{--rose:#d4849f;--pink:#f8b4c8;--blush:#ffe6f0;--gold:#d4a574;--cream:#fff8f0;--wine:#8b3a62;--lav:#c9b1ff;--txt:#4a2040}
*{margin:0;padding:0;box-sizing:border-box}
body{font-family:'Quicksand',sans-serif;color:var(--txt);min-height:100vh;overflow-x:hidden;background:radial-gradient(ellipse at 20% 50%,rgba(248,180,200,.4),transparent 50%),radial-gradient(ellipse at 80% 20%,rgba(201,177,255,.3),transparent 50%),linear-gradient(180deg,#fff8f0,#ffe6f0 50%,#f0e0ff);touch-action:manipulation}
h1,h2{font-family:'Playfair Display',serif}
.screen{display:none;flex-direction:column;align-items:center;padding:16px;min-height:100vh}.screen.active{display:flex}
.glass{background:rgba(255,255,255,.55);backdrop-filter:blur(12px);-webkit-backdrop-filter:blur(12px);border:1px solid rgba(255,255,255,.7);border-radius:20px;box-shadow:0 8px 32px rgba(183,110,121,.1)}
#hub{padding-top:24px;gap:14px}
#hub h1{font-size:1.7em;background:linear-gradient(135deg,var(--wine),var(--rose));-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text}
.subtitle{font-size:.8em;color:var(--rose);letter-spacing:2px;text-transform:uppercase}
.panda-wrap{position:relative;width:160px;height:180px;margin:5px auto}
.pp{transition:opacity .8s,transform .8s}.pp.hid{opacity:0;transform:scale(.5)}
.p-face{width:120px;height:110px;background:#fff;border-radius:50%;position:absolute;top:45px;left:20px;border:2.5px solid #555}
.panda .ear{width:48px;height:48px;background:#333;border-radius:50%;position:absolute;border:2.5px solid #555}
.panda .ear.l{top:10px;left:2px}.panda .ear.r{top:10px;right:2px}
.panda .ear-in{width:22px;height:22px;background:#ffb0c8;border-radius:50%;position:absolute;top:10px;left:13px}
.panda .patch{width:34px;height:28px;background:#333;border-radius:50%;position:absolute;top:65px}
.panda .patch.l{left:34px;transform:rotate(-5deg)}.panda .patch.r{right:34px;transform:rotate(5deg)}
.panda .eye{width:11px;height:13px;background:#fff;border-radius:50%;position:absolute;top:7px}
.panda .eye.l{left:13px}.panda .eye.r{right:7px}
.panda .pupil{width:5px;height:6px;background:#111;border-radius:50%;position:absolute;top:4px;left:3px}
.panda .nose{width:14px;height:10px;background:#333;border-radius:50%;position:absolute;top:94px;left:50%;transform:translateX(-50%)}
.panda .mouth{position:absolute;top:103px;left:50%;transform:translateX(-50%);width:26px;height:10px}
.panda .mouth::before,.panda .mouth::after{content:'';position:absolute;top:0;width:13px;height:10px;border-bottom:2.5px solid #555;border-radius:0 0 50% 50%}
.panda .mouth::before{left:0}.panda .mouth::after{right:0}
.panda .blush{width:20px;height:12px;background:rgba(255,155,180,.5);border-radius:50%;position:absolute;top:92px}
.panda .blush.l{left:24px}.panda .blush.r{right:24px}
.p-sil{width:120px;height:110px;background:#f0e0ee;border-radius:50%;position:absolute;top:45px;left:20px;border:2.5px dashed #dcc;display:flex;align-items:center;justify-content:center;font-size:2.2em;color:#dcc}
#hints{display:flex;flex-direction:column;gap:6px;width:100%;max-width:360px}
.hint-item{padding:8px 14px;font-size:.82em;text-align:center;border-radius:14px;animation:fadeUp .5s}
@keyframes fadeUp{from{opacity:0;transform:translateY(8px)}to{opacity:1;transform:translateY(0)}}
.pin-grid{display:grid;grid-template-columns:1fr 1fr;gap:10px;width:100%;max-width:380px}
.pin{border-radius:18px;overflow:hidden;cursor:pointer;transition:transform .2s;background:#fff;box-shadow:0 4px 20px rgba(139,58,98,.1);position:relative}
.pin:active{transform:scale(.97)}.pin.done{opacity:.65;pointer-events:none}
.pin:last-child{grid-column:1/-1}
.pin-bg{height:130px;background-size:cover;background-position:center;position:relative;display:flex;align-items:center;justify-content:center}
.pin-bg::after{content:'';position:absolute;inset:0;background:linear-gradient(to bottom,transparent 30%,rgba(255,255,255,.85))}
.pin-emoji{font-size:2.8em;position:relative;z-index:1;filter:drop-shadow(0 2px 4px rgba(0,0,0,.15))}
.pin-info{padding:10px 12px}.pin-name{font-family:'Playfair Display',serif;font-weight:700;font-size:1em;color:var(--wine)}
.pin-desc{font-size:.7em;color:var(--rose);margin-top:2px}
.pin-status{position:absolute;top:8px;right:8px;z-index:2;font-size:.75em;background:rgba(255,255,255,.7);border-radius:50%;width:28px;height:28px;display:flex;align-items:center;justify-content:center;backdrop-filter:blur(4px)}
.game-screen{padding-top:12px;gap:8px}
.game-header{display:flex;align-items:center;justify-content:space-between;width:100%;max-width:380px;padding:0 5px}
.btn-back{background:none;border:none;font-size:1.4em;cursor:pointer;padding:6px 10px;color:var(--wine)}
.game-title{font-family:'Playfair Display',serif;font-size:1.1em;font-weight:700;color:var(--wine)}
.game-info{font-size:.85em;color:var(--rose);font-weight:600}
.game-goal{font-size:.78em;color:var(--rose);text-align:center;font-weight:600;margin-bottom:4px}
.grid-2048{display:grid;grid-template-columns:repeat(4,1fr);gap:6px;border-radius:14px;padding:8px;width:min(82vw,320px);aspect-ratio:1;background:rgba(139,58,98,.08)}
.tile{border-radius:8px;display:flex;align-items:center;justify-content:center;font-weight:700;font-size:1.3em;aspect-ratio:1;background:rgba(255,255,255,.4);color:var(--wine);transition:all .1s}
.t2{background:#ffe6f0}.t4{background:#ffd0e0}.t8{background:#ffb0c8;color:#fff}.t16{background:#ff90b0;color:#fff}
.t32{background:#ff70a0;color:#fff}.t64{background:#e8609a;color:#fff}.t128{background:#d050a0;color:#fff;font-size:1.1em}
.t256{background:#b840a0;color:#fff;font-size:1em}.t512{background:#a030a0;color:#fff;font-size:1em}
.t1024{background:linear-gradient(135deg,#c040b0,#8030a0);color:#fff;font-size:.85em}
.t2048{background:linear-gradient(135deg,#ffd700,#ff69b4);color:#fff;font-size:.85em;animation:glow 1s infinite alternate}
@keyframes glow{from{box-shadow:0 0 8px rgba(255,215,0,.5)}to{box-shadow:0 0 20px rgba(255,105,180,.7)}}
.tetris-wrap{display:flex;gap:10px;align-items:flex-start}
.tetris-board{display:grid;grid-template-columns:repeat(10,1fr);gap:1px;background:#1a0a20;border-radius:10px;padding:3px;width:min(58vw,230px)}
.tc{aspect-ratio:1;border-radius:2px;background:#2a1a30}
.tetris-side{display:flex;flex-direction:column;gap:8px;align-items:center}
.next-label{font-size:.65em;color:var(--rose);font-weight:600;letter-spacing:2px}
.tetris-next{background:#1a0a20;border-radius:8px;padding:6px;display:grid;grid-template-columns:repeat(4,16px);grid-template-rows:repeat(4,16px);gap:1px}
.tn{border-radius:2px;background:#2a1a30}
.t-ctrls{display:flex;flex-wrap:wrap;gap:6px;justify-content:center;margin-top:10px;max-width:240px}
.t-btn{width:54px;height:54px;border:none;border-radius:14px;font-size:1.3em;cursor:pointer;background:rgba(255,255,255,.7);color:var(--wine);display:flex;align-items:center;justify-content:center;box-shadow:0 2px 8px rgba(139,58,98,.1)}.t-btn:active{transform:scale(.9)}.t-btn-w{width:118px}
#breaker-canvas{border-radius:14px;background:#1a0a20;width:min(88vw,350px);touch-action:none}
.touch-hint{font-size:.7em;color:var(--rose);margin-top:6px}
.mem-grid{display:grid;grid-template-columns:repeat(6,1fr);gap:6px;width:min(92vw,360px)}
.mc{aspect-ratio:1;border-radius:10px;cursor:pointer;perspective:600px}
.mc-in{width:100%;height:100%;transition:transform .35s;transform-style:preserve-3d;position:relative}
.mc.flip .mc-in{transform:rotateY(180deg)}
.mc-f,.mc-b{position:absolute;width:100%;height:100%;border-radius:10px;display:flex;align-items:center;justify-content:center;backface-visibility:hidden}
.mc-f{background:linear-gradient(135deg,var(--rose),var(--lav));color:rgba(255,255,255,.6);font-size:1em}
.mc-b{background:#fff;transform:rotateY(180deg);font-size:1.4em;box-shadow:0 2px 8px rgba(0,0,0,.08)}
.mc.matched .mc-b{background:var(--blush)}.mc.matched{pointer-events:none}
.merge-grid{display:grid;grid-template-columns:repeat(5,1fr);gap:6px;width:min(82vw,310px);padding:8px;border-radius:14px;background:rgba(139,58,98,.06)}
.mg-cell{aspect-ratio:1;border-radius:10px;display:flex;align-items:center;justify-content:center;font-size:1.6em;cursor:pointer;transition:all .15s;background:rgba(255,255,255,.4);border:2px solid transparent}
.mg-cell.sel{border-color:var(--rose);box-shadow:0 0 12px rgba(212,132,159,.4);transform:scale(1.06)}
.mg-cell.empty{background:rgba(255,255,255,.15);cursor:default}
.mg-cell.l1{background:#ffe6f0}.mg-cell.l2{background:#ffd0e0}.mg-cell.l3{background:#ffc0d5}
.mg-cell.l4{background:#ffb0ca}.mg-cell.l5{background:#ffa0bf}.mg-cell.l6{background:#e890b5}
.mg-cell.l7{background:#d080aa}.mg-cell.l8{background:#b870a0}
.mg-cell.l9{background:linear-gradient(135deg,#ffd700,#ff69b4)}
.mg-over{display:none;text-align:center;padding:12px;font-size:.9em;color:var(--wine)}
.mg-over.show{display:block}
.mg-restart{background:var(--rose);color:#fff;border:none;border-radius:10px;padding:8px 20px;cursor:pointer;font-family:'Quicksand';font-weight:600;margin-top:6px}
#win-overlay{display:none;position:fixed;inset:0;background:rgba(74,32,64,.5);z-index:100;align-items:center;justify-content:center;backdrop-filter:blur(6px)}
#win-overlay.active{display:flex}
.win-box{border-radius:24px;padding:28px;text-align:center;max-width:300px;width:88%;animation:pop .5s}
.win-box h2{font-size:1.4em;color:var(--wine);margin-bottom:6px}
.win-box .hint{color:var(--rose);font-size:1em;margin:10px 0;font-weight:600}
.win-box .prog{font-size:.8em;color:#999;margin-bottom:14px}
.win-btn{background:linear-gradient(135deg,var(--rose),var(--lav));color:#fff;border:none;border-radius:14px;padding:11px 26px;font-size:.95em;cursor:pointer;font-weight:700;font-family:'Quicksand'}.win-btn:active{transform:scale(.95)}
@keyframes pop{0%{transform:scale(.3);opacity:0}50%{transform:scale(1.05)}100%{transform:scale(1);opacity:1}}
#celeb{justify-content:center;gap:18px;position:relative;overflow:hidden;background:radial-gradient(ellipse at 50% 40%,rgba(255,215,0,.15),transparent 60%),radial-gradient(ellipse at 50% 50%,rgba(248,180,200,.3),transparent 70%),linear-gradient(180deg,#fff8f0,#ffe6f0,#f0e0ff)}
#celeb h1{font-size:1.8em;color:var(--wine);z-index:2;text-align:center}
#celeb .final-panda{transform:scale(1.4);z-index:2;margin:15px 0}
#celeb .final-panda .pp{opacity:1!important;transform:scale(1)!important}
.msg{font-size:1.15em;text-align:center;color:var(--wine);font-weight:600;z-index:2;max-width:280px;line-height:1.6}
.confetti-wrap{position:fixed;inset:0;pointer-events:none;z-index:1;overflow:hidden}
.conf{position:absolute;width:8px;height:8px;top:-10px;animation:fall linear forwards}
@keyframes fall{0%{transform:translateY(0) rotate(0);opacity:1}100%{transform:translateY(110vh) rotate(720deg);opacity:0}}
.heart-fly{position:fixed;font-size:1.3em;animation:hfly 3s ease-out forwards;pointer-events:none;z-index:50}
@keyframes hfly{0%{transform:translateY(0) scale(1);opacity:1}100%{transform:translateY(-180px) scale(.3);opacity:0}}
.reset-area{margin-top:16px;z-index:2}
.reset-btn{background:rgba(255,255,255,.4);border:1.5px solid rgba(139,58,98,.2);color:var(--wine);border-radius:12px;padding:8px 22px;cursor:pointer;font-size:.82em;font-family:'Quicksand';font-weight:600}
</style></head>
<body>
<div id="hub" class="screen active">
<div class="subtitle">special gift</div><h1>ë¹„ë°€ ì„ ë¬¼ì„ ì°¾ì•„ë¼</h1>
<div class="panda-wrap panda" id="panda">
<div class="p-sil" id="p-sil">?</div>
<div class="p-face pp hid" id="pf"></div>
<div class="ear l pp hid" id="pe1"><div class="ear-in"></div></div>
<div class="ear r pp hid" id="pe2"><div class="ear-in"></div></div>
<div class="patch l pp hid" id="pp1"><div class="eye l"><div class="pupil"></div></div></div>
<div class="patch r pp hid" id="pp2"><div class="eye r"><div class="pupil"></div></div></div>
<div class="nose pp hid" id="pn"></div>
<div class="mouth pp hid" id="pm"></div>
<div class="blush l pp hid" id="pb1"></div>
<div class="blush r pp hid" id="pb2"></div>
</div>
<div id="hints"></div>
<div class="pin-grid">
<div class="pin" id="pin0" onclick="startGame(0)"><div class="pin-bg" style="background:url('https://picsum.photos/seed/sunset7/400/280') center/cover,linear-gradient(135deg,#ffecd2,#fcb69f)"><span class="pin-emoji">ğŸ”¢</span></div><div class="pin-status" id="ps0">ğŸ”’</div><div class="pin-info"><div class="pin-name">2048</div><div class="pin-desc">ìˆ«ìë¥¼ í•©ì³ì„œ 2048 ë§Œë“¤ê¸°</div></div></div>
<div class="pin" id="pin1" onclick="startGame(1)"><div class="pin-bg" style="background:url('https://picsum.photos/seed/purple42/400/280') center/cover,linear-gradient(135deg,#a18cd1,#fbc2eb)"><span class="pin-emoji">ğŸ§±</span></div><div class="pin-status" id="ps1">ğŸ”’</div><div class="pin-info"><div class="pin-name">í…ŒíŠ¸ë¦¬ìŠ¤</div><div class="pin-desc">40ì¤„ì„ ì™„ì„±í•˜ë¼</div></div></div>
<div class="pin" id="pin2" onclick="startGame(2)"><div class="pin-bg" style="background:url('https://picsum.photos/seed/pinkfl5/400/280') center/cover,linear-gradient(135deg,#f093fb,#f5576c)"><span class="pin-emoji">ğŸ“</span></div><div class="pin-status" id="ps2">ğŸ”’</div><div class="pin-info"><div class="pin-name">ë²½ëŒê¹¨ê¸°</div><div class="pin-desc">3 ìŠ¤í…Œì´ì§€ ëŒíŒŒ</div></div></div>
<div class="pin" id="pin3" onclick="startGame(3)"><div class="pin-bg" style="background:url('https://picsum.photos/seed/lavend8/400/280') center/cover,linear-gradient(135deg,#fbc2eb,#a6c1ee)"><span class="pin-emoji">ğŸƒ</span></div><div class="pin-status" id="ps3">ğŸ”’</div><div class="pin-info"><div class="pin-name">ë©”ëª¨ë¦¬ ì¹´ë“œ</div><div class="pin-desc">18ìŒ ëª¨ë‘ ë§ì¶”ê¸°</div></div></div>
<div class="pin" id="pin4" onclick="startGame(4)"><div class="pin-bg" style="background:url('https://picsum.photos/seed/roseg3/400/280') center/cover,linear-gradient(135deg,#d4a574,#e8b4b8)"><span class="pin-emoji">ğŸ§©</span></div><div class="pin-status" id="ps4">ğŸ”’</div><div class="pin-info"><div class="pin-name">ë¨¸ì§€ë¨¸ì§€</div><div class="pin-desc">Lv.9 ì•„ì´í…œ ë§Œë“¤ê¸°</div></div></div>
</div></div>
<div id="s-2048" class="screen game-screen"><div class="game-header"><button class="btn-back" onclick="goHub()">â†</button><span class="game-title">2048</span><span class="game-info" id="sc0">0</span></div><div class="game-goal">2048 íƒ€ì¼ì„ ë§Œë“¤ë©´ í´ë¦¬ì–´!</div><div class="grid-2048" id="g2048"></div></div>
<div id="s-tetris" class="screen game-screen"><div class="game-header"><button class="btn-back" onclick="goHub()">â†</button><span class="game-title">í…ŒíŠ¸ë¦¬ìŠ¤</span><span class="game-info" id="sc1">0/40</span></div><div class="game-goal">40ì¤„ í´ë¦¬ì–´í•˜ë©´ ì„±ê³µ!</div><div class="tetris-wrap"><div class="tetris-board" id="tboard"></div><div class="tetris-side"><div class="next-label">NEXT</div><div class="tetris-next" id="tnext"></div></div></div><div class="t-ctrls"><button class="t-btn" onclick="tMove('left')">â—€</button><button class="t-btn" onclick="tMove('down')">â–¼</button><button class="t-btn" onclick="tMove('right')">â–¶</button><button class="t-btn" onclick="tMove('rotate')">â†»</button><button class="t-btn t-btn-w" onclick="tMove('drop')">â¬ ë“œë¡­</button></div></div>
<div id="s-breaker" class="screen game-screen"><div class="game-header"><button class="btn-back" onclick="goHub()">â†</button><span class="game-title">ë²½ëŒê¹¨ê¸°</span><span class="game-info" id="sc2">Stage 1 â¤ï¸â¤ï¸â¤ï¸</span></div><div class="game-goal">3 ìŠ¤í…Œì´ì§€ í´ë¦¬ì–´!</div><canvas id="breaker-canvas"></canvas><div class="touch-hint">í„°ì¹˜ ë˜ëŠ” ë§ˆìš°ìŠ¤ë¡œ íŒ¨ë“¤ ì¡°ì‘</div></div>
<div id="s-memory" class="screen game-screen"><div class="game-header"><button class="btn-back" onclick="goHub()">â†</button><span class="game-title">ë©”ëª¨ë¦¬ ì¹´ë“œ</span><span class="game-info" id="sc3">0/18</span></div><div class="game-goal">18ìŒ ëª¨ë‘ ë§ì¶”ë©´ í´ë¦¬ì–´!</div><div class="mem-grid" id="mgrid"></div></div>
<div id="s-merge" class="screen game-screen"><div class="game-header"><button class="btn-back" onclick="goHub()">â†</button><span class="game-title">ë¨¸ì§€ë¨¸ì§€</span><span class="game-info" id="sc4">ìµœê³  Lv.1</span></div><div class="game-goal">ğŸ‘‘ Lv.9 ì•„ì´í…œì„ ë§Œë“¤ë©´ í´ë¦¬ì–´!</div><div class="merge-grid" id="mrgrid"></div><div class="mg-over" id="mgover">ê²Œì„ ì˜¤ë²„!<br><button class="mg-restart" onclick="restartMerge()">ë‹¤ì‹œ ì‹œì‘</button></div></div>
<div id="win-overlay"><div class="win-box glass"><h2 id="wtitle">í´ë¦¬ì–´!</h2><div class="hint" id="whint"></div><div class="prog" id="wprog"></div><button class="win-btn" onclick="closeWin()">í™•ì¸</button></div></div>
<div id="celeb" class="screen"><div class="confetti-wrap" id="confwrap"></div><h1>ì„ ë¬¼ì„ ì°¾ì•˜ë‹¤! ğŸ‰</h1><div class="panda-wrap panda final-panda"><div class="p-face pp"></div><div class="ear l pp"><div class="ear-in"></div></div><div class="ear r pp"><div class="ear-in"></div></div><div class="patch l pp"><div class="eye l"><div class="pupil"></div></div></div><div class="patch r pp"><div class="eye r"><div class="pupil"></div></div></div><div class="nose pp"></div><div class="mouth pp"></div><div class="blush l pp"></div><div class="blush r pp"></div></div><div class="msg">ì„ ë¬¼ì€ ë°”ë¡œ...<br><span style="font-size:1.8em">ğŸ¼ íŒ¬ë”!</span><br><br>ì‚¬ë‘í•´ â¤ï¸</div><div class="reset-area"><button class="reset-btn" onclick="resetAll()">ì²˜ìŒë¶€í„° ë‹¤ì‹œí•˜ê¸°</button></div></div>
<script>
/* STATE */
const HINTS=['í‘ë°±ì˜ ê·€ì—¬ìš´ ë™ë¬¼ì´ì•¼ ğŸ–¤ğŸ¤','ëˆˆ ì£¼ìœ„ê°€ ê¹Œë§£ëŒ€... ë¬´ì„œìš´ ê±´ ì•„ë‹ˆì•¼ ğŸ‘€','ëŒ€ë‚˜ë¬´ë¥¼ ì—„ì²­ ì¢‹ì•„í•´ ğŸ‹','ë’¤ëš±ë’¤ëš± ê±¸ì–´ë‹¤ë…€ ğŸ¾','ë°”ë¡œ... ê³§ ë§Œë‚˜ê²Œ ë  ê±°ì•¼! ğŸ’•'];
const PP=[['pf'],['pe1','pe2'],['pp1','pp2'],['pn'],['pm','pb1','pb2']];
let done=JSON.parse(localStorage.getItem('pg5')||'[0,0,0,0,0]');
let activeGame=null;
const save=()=>localStorage.setItem('pg5',JSON.stringify(done));
function show(id){document.querySelectorAll('.screen').forEach(s=>s.classList.remove('active'));document.getElementById(id).classList.add('active')}
function goHub(){if(activeGame?.stop)activeGame.stop();activeGame=null;show('hub');updateHub()}
function startGame(i){if(done[i])return;show(['s-2048','s-tetris','s-breaker','s-memory','s-merge'][i]);activeGame=[()=>new Game2048(),()=>new Tetris(),()=>new Breaker(),()=>new Memory(),()=>new MergeGame()][i]()}
function gameWin(i){if(activeGame?.stop)activeGame.stop();activeGame=null;done[i]=1;save();document.getElementById('wtitle').textContent='ğŸ‰ í´ë¦¬ì–´!';document.getElementById('whint').textContent='Hint: '+HINTS[i];document.getElementById('wprog').textContent='íŒ¬ë” ì™„ì„±ë„ '+done.filter(x=>x).length+'/5';document.getElementById('win-overlay').classList.add('active')}
function closeWin(){document.getElementById('win-overlay').classList.remove('active');goHub()}
function updateHub(){
  done.forEach((d,i)=>{const ps=document.getElementById('ps'+i);if(d){document.getElementById('pin'+i).classList.add('done');ps.textContent='âœ“';ps.style.background='rgba(76,175,80,.8)';ps.style.color='#fff'}});
  if(done.some(d=>d))document.getElementById('p-sil').style.display='none';
  done.forEach((d,i)=>PP[i].forEach(id=>{const el=document.getElementById(id);if(el){if(d)el.classList.remove('hid');else el.classList.add('hid')}}));
  const h=document.getElementById('hints');h.innerHTML='';
  done.forEach((d,i)=>{if(d){const div=document.createElement('div');div.className='hint-item glass';div.textContent='âœ¦ '+HINTS[i];h.appendChild(div)}});
  if(done.every(d=>d))setTimeout(()=>{show('celeb');celebrate()},800);
}
function celebrate(){const w=document.getElementById('confwrap');w.innerHTML='';const cols=['#ff6b9d','#c9b1ff','#ffd700','#f093fb','#a8d8ea','#ffc6d9'];for(let i=0;i<60;i++){const c=document.createElement('div');c.className='conf';c.style.left=Math.random()*100+'%';c.style.background=cols[i%cols.length];c.style.width=(5+Math.random()*7)+'px';c.style.height=c.style.width;c.style.borderRadius=Math.random()>.5?'50%':'2px';c.style.animationDuration=(2+Math.random()*3)+'s';c.style.animationDelay=Math.random()*2+'s';w.appendChild(c)}setInterval(()=>{const h=document.createElement('div');h.className='heart-fly';h.textContent=['â¤ï¸','ğŸ’•','ğŸ’–','ğŸ©·'][Math.random()*4|0];h.style.left=(10+Math.random()*80)+'%';h.style.bottom='10%';document.body.appendChild(h);setTimeout(()=>h.remove(),3000)},700)}
function resetAll(){done=[0,0,0,0,0];save();document.querySelectorAll('.pin').forEach(p=>p.classList.remove('done'));for(let i=0;i<5;i++){const ps=document.getElementById('ps'+i);ps.textContent='ğŸ”’';ps.style.background='rgba(255,255,255,.7)';ps.style.color=''}document.getElementById('p-sil').style.display='flex';goHub()}
function restartMerge(){activeGame=new MergeGame()}
if(!CanvasRenderingContext2D.prototype.roundRect){CanvasRenderingContext2D.prototype.roundRect=function(x,y,w,h,r){this.moveTo(x+r,y);this.lineTo(x+w-r,y);this.quadraticCurveTo(x+w,y,x+w,y+r);this.lineTo(x+w,y+h-r);this.quadraticCurveTo(x+w,y+h,x+w-r,y+h);this.lineTo(x+r,y+h);this.quadraticCurveTo(x,y+h,x,y+h-r);this.lineTo(x,y+r);this.quadraticCurveTo(x,y,x+r,y);this.closePath()}}

/* 2048 */
class Game2048{
  constructor(){this.g=Array(4).fill(0).map(()=>Array(4).fill(0));this.sc=0;this.won=false;this.el=document.getElementById('g2048');this.add();this.add();this.render();this._kh=e=>this.onKey(e);this._ts=null;this._tsh=e=>{const t=e.touches[0];this._ts={x:t.clientX,y:t.clientY}};this._teh=e=>{if(!this._ts)return;const t=e.changedTouches[0],dx=t.clientX-this._ts.x,dy=t.clientY-this._ts.y;if(Math.abs(dx)<30&&Math.abs(dy)<30)return;Math.abs(dx)>Math.abs(dy)?this.move(dx>0?'r':'l'):this.move(dy>0?'d':'u');this._ts=null};document.addEventListener('keydown',this._kh);this.el.addEventListener('touchstart',this._tsh,{passive:true});this.el.addEventListener('touchend',this._teh,{passive:true})}
  stop(){document.removeEventListener('keydown',this._kh);this.el.removeEventListener('touchstart',this._tsh);this.el.removeEventListener('touchend',this._teh)}
  add(){const e=[];for(let r=0;r<4;r++)for(let c=0;c<4;c++)if(!this.g[r][c])e.push([r,c]);if(!e.length)return;const[r,c]=e[Math.random()*e.length|0];this.g[r][c]=Math.random()<.9?2:4}
  onKey(e){const m={ArrowLeft:'l',ArrowRight:'r',ArrowUp:'u',ArrowDown:'d'};if(m[e.key]){e.preventDefault();this.move(m[e.key])}}
  move(d){if(this.won)return;const prev=JSON.stringify(this.g);const merge=line=>{let f=line.filter(x=>x);for(let i=0;i<f.length-1;i++)if(f[i]===f[i+1]){f[i]*=2;this.sc+=f[i];f.splice(i+1,1)}while(f.length<4)f.push(0);return f};let g=this.g.map(r=>[...r]);if(d==='l')g=g.map(r=>merge(r));else if(d==='r')g=g.map(r=>merge([...r].reverse()).reverse());else if(d==='u'){for(let c=0;c<4;c++){let col=[g[0][c],g[1][c],g[2][c],g[3][c]];col=merge(col);for(let r=0;r<4;r++)g[r][c]=col[r]}}else{for(let c=0;c<4;c++){let col=[g[3][c],g[2][c],g[1][c],g[0][c]];col=merge(col);for(let r=0;r<4;r++)g[r][c]=col[3-r]}}this.g=g;if(JSON.stringify(this.g)!==prev){this.add();this.render();for(let r=0;r<4;r++)for(let c=0;c<4;c++)if(this.g[r][c]>=2048&&!this.won){this.won=true;setTimeout(()=>gameWin(0),400)}}}
  render(){document.getElementById('sc0').textContent=this.sc;this.el.innerHTML='';for(let r=0;r<4;r++)for(let c=0;c<4;c++){const d=document.createElement('div'),v=this.g[r][c];d.className='tile'+(v?' t'+v:'');d.textContent=v||'';this.el.appendChild(d)}}
}

/* TETRIS */
class Tetris{
  constructor(){this.W=10;this.H=18;this.board=Array(this.H).fill(0).map(()=>Array(this.W).fill(0));this.lines=0;this.won=false;this.running=true;this.SH=[{s:[[1,1,1,1]],c:'#ffb3c6'},{s:[[1,1],[1,1]],c:'#ffd6a5'},{s:[[0,1,0],[1,1,1]],c:'#c9b1ff'},{s:[[0,1,1],[1,1,0]],c:'#a8d8ea'},{s:[[1,1,0],[0,1,1]],c:'#ffaaa5'},{s:[[1,0],[1,0],[1,1]],c:'#d4a5ff'},{s:[[0,1],[0,1],[1,1]],c:'#ffc6d9'}];this.piece=null;this.next=this.rp();this.spawn();this.bEl=document.getElementById('tboard');this.nEl=document.getElementById('tnext');this.initDom();this.render();this._kh=e=>this.onKey(e);document.addEventListener('keydown',this._kh);this._iv=setInterval(()=>this.tick(),this.speed)}
  get speed(){if(this.lines<10)return 600;if(this.lines<20)return 450;if(this.lines<30)return 350;return 280}
  stop(){this.running=false;clearInterval(this._iv);document.removeEventListener('keydown',this._kh)}
  rp(){return this.SH[Math.random()*this.SH.length|0]}
  spawn(){const p=this.next;this.next=this.rp();this.piece={s:p.s.map(r=>[...r]),c:p.c,x:((this.W-p.s[0].length)/2|0),y:0};if(!this.ok(this.piece.s,this.piece.x,this.piece.y))this.stop()}
  ok(s,px,py){for(let r=0;r<s.length;r++)for(let c=0;c<s[r].length;c++){if(!s[r][c])continue;const nx=px+c,ny=py+r;if(nx<0||nx>=this.W||ny>=this.H)return false;if(ny>=0&&this.board[ny][nx])return false}return true}
  lock(){const{s,x,y,c}=this.piece;for(let r=0;r<s.length;r++)for(let cc=0;cc<s[r].length;cc++)if(s[r][cc]&&y+r>=0)this.board[y+r][x+cc]=c;this.clr();this.spawn();this.render();clearInterval(this._iv);this._iv=setInterval(()=>this.tick(),this.speed)}
  clr(){let cl=0;for(let r=this.H-1;r>=0;r--)if(this.board[r].every(c=>c)){this.board.splice(r,1);this.board.unshift(Array(this.W).fill(0));cl++;r++}if(cl){this.lines+=cl;document.getElementById('sc1').textContent=this.lines+'/40'}if(this.lines>=40&&!this.won){this.won=true;this.stop();setTimeout(()=>gameWin(1),300)}}
  tick(){if(!this.running)return;if(this.ok(this.piece.s,this.piece.x,this.piece.y+1))this.piece.y++;else this.lock();this.render()}
  ml(){if(this.ok(this.piece.s,this.piece.x-1,this.piece.y)){this.piece.x--;this.render()}}
  mr(){if(this.ok(this.piece.s,this.piece.x+1,this.piece.y)){this.piece.x++;this.render()}}
  md(){if(this.ok(this.piece.s,this.piece.x,this.piece.y+1)){this.piece.y++;this.render()}}
  rot(){const s=this.piece.s,h=s.length,w=s[0].length;const ns=Array(w).fill(0).map((_,r)=>Array(h).fill(0).map((_,c)=>s[h-1-c][r]));if(this.ok(ns,this.piece.x,this.piece.y)){this.piece.s=ns;this.render()}}
  drop(){while(this.ok(this.piece.s,this.piece.x,this.piece.y+1))this.piece.y++;this.lock()}
  onKey(e){if(!this.running)return;const m={ArrowLeft:'l',ArrowRight:'r',ArrowDown:'d',ArrowUp:'rot',' ':'drop'};if(m[e.key]){e.preventDefault();tMove(m[e.key])}}
  initDom(){this.bEl.innerHTML='';for(let i=0;i<this.H*this.W;i++){const d=document.createElement('div');d.className='tc';this.bEl.appendChild(d)}this.nEl.innerHTML='';for(let i=0;i<16;i++){const d=document.createElement('div');d.className='tn';this.nEl.appendChild(d)}}
  render(){const cells=this.bEl.children;for(let r=0;r<this.H;r++)for(let c=0;c<this.W;c++)cells[r*this.W+c].style.background=this.board[r][c]||'#2a1a30';if(this.piece){const{s,x,y,c}=this.piece;for(let r=0;r<s.length;r++)for(let cc=0;cc<s[r].length;cc++)if(s[r][cc]&&y+r>=0&&y+r<this.H&&x+cc>=0&&x+cc<this.W)cells[(y+r)*this.W+(x+cc)].style.background=c}const nc=this.nEl.children;for(let i=0;i<16;i++)nc[i].style.background='#2a1a30';if(this.next){const ns=this.next.s;for(let r=0;r<ns.length;r++)for(let c=0;c<ns[r].length;c++)if(ns[r][c])nc[r*4+c].style.background=this.next.c}}
}
function tMove(d){if(!activeGame||!(activeGame instanceof Tetris)||!activeGame.running)return;if(d==='l'||d==='left')activeGame.ml();else if(d==='r'||d==='right')activeGame.mr();else if(d==='d'||d==='down')activeGame.md();else if(d==='rot'||d==='rotate')activeGame.rot();else activeGame.drop()}

/* MERGE - ê³¼ì¼ í…Œë§ˆ */
class MergeGame{
  constructor(){this.W=5;this.H=5;this.sel=null;this.won=false;this.maxLv=1;this.items=['','ğŸ’','ğŸ“','ğŸŠ','ğŸ‹','ğŸ','ğŸ‘','ğŸ‰','ğŸ‡','ğŸ¥'];this.grid=Array(this.H).fill(0).map(()=>Array(this.W).fill(0).map(()=>{const r=Math.random();return r<.65?1:r<.85?2:r<.95?3:0}));this.el=document.getElementById('mrgrid');document.getElementById('mgover').classList.remove('show');this.render()}
  stop(){}
  tap(r,c){if(this.won)return;const v=this.grid[r][c];if(!v)return;if(this.sel){const{r:sr,c:sc}=this.sel;if(sr===r&&sc===c){this.sel=null;this.render();return}if(Math.abs(sr-r)+Math.abs(sc-c)===1&&this.grid[sr][sc]===v){const nv=v+1;this.grid[r][c]=nv;this.grid[sr][sc]=0;this.sel=null;if(nv>this.maxLv){this.maxLv=nv;document.getElementById('sc4').textContent='ìµœê³  Lv.'+nv}this.spawnNew();if(nv>=9&&!this.won){this.won=true;setTimeout(()=>gameWin(4),500)}else if(this.isOver())document.getElementById('mgover').classList.add('show');this.render()}else{this.sel={r,c};this.render()}}else{this.sel={r,c};this.render()}}
  spawnNew(){const e=[];for(let r=0;r<this.H;r++)for(let c=0;c<this.W;c++)if(!this.grid[r][c])e.push([r,c]);if(!e.length)return;const[r,c]=e[Math.random()*e.length|0];const rng=Math.random();this.grid[r][c]=rng<.75?1:rng<.92?2:3}
  isOver(){for(let r=0;r<this.H;r++)for(let c=0;c<this.W;c++){if(!this.grid[r][c])return false;const v=this.grid[r][c];if(r+1<this.H&&this.grid[r+1][c]===v)return false;if(c+1<this.W&&this.grid[r][c+1]===v)return false}return true}
  render(){this.el.innerHTML='';for(let r=0;r<this.H;r++)for(let c=0;c<this.W;c++){const d=document.createElement('div'),v=this.grid[r][c];d.className='mg-cell'+(v?' l'+v:' empty')+(this.sel&&this.sel.r===r&&this.sel.c===c?' sel':'');d.textContent=v?this.items[v]:'';d.addEventListener('click',()=>this.tap(r,c));this.el.appendChild(d)}}
}

/* BREAKER - 3 stages */
class Breaker{
  constructor(){this.cv=document.getElementById('breaker-canvas');this.ctx=this.cv.getContext('2d');const w=Math.min(window.innerWidth*.88,350);this.cv.width=w;this.cv.height=w*1.3;this.W=this.cv.width;this.H=this.cv.height;this.STG=[{rows:5,cols:7,pw:65,spd:3},{rows:6,cols:7,pw:55,spd:3.5},{rows:7,cols:8,pw:45,spd:4}];this.stage=0;this.lives=3;this.won=false;this.running=true;this.started=false;this.br=6;this.ph=12;this.setupStage();this._mh=e=>{const r=this.cv.getBoundingClientRect();const cx=e.clientX||e.touches?.[0]?.clientX;if(cx)this.px=Math.max(0,Math.min(this.W-this.pw,cx-r.left-this.pw/2));if(!this.started)this.started=true};this.cv.addEventListener('mousemove',this._mh);this.cv.addEventListener('touchmove',e=>{e.preventDefault();this._mh(e)},{passive:false});this.cv.addEventListener('click',()=>{if(!this.started)this.started=true});this._raf=null;this.loop()}
  stop(){this.running=false;cancelAnimationFrame(this._raf)}
  setupStage(){const cfg=this.STG[this.stage];this.pw=cfg.pw;this.spd=cfg.spd;this.px=(this.W-this.pw)/2;this.ball={x:this.W/2,y:this.H-50,dx:this.spd*(Math.random()>.5?1:-1),dy:-this.spd};this.started=false;this.bricks=[];const bw=(this.W-(cfg.cols+1)*4)/cfg.cols,bh=16;const colors=['#ffb3c6','#c9b1ff','#ffd6a5','#a8d8ea','#d4a5ff','#ffaaa5','#ffc6d9','#b8e6c8'];for(let r=0;r<cfg.rows;r++)for(let c=0;c<cfg.cols;c++)this.bricks.push({x:4+(bw+4)*c,y:35+(bh+4)*r,w:bw,h:bh,color:colors[r%colors.length]});this.updateInfo()}
  resetBall(){this.ball={x:this.W/2,y:this.H-50,dx:this.spd*(Math.random()>.5?1:-1),dy:-this.spd};this.started=false}
  updateInfo(){document.getElementById('sc2').textContent='Stage '+(this.stage+1)+' '+'â¤ï¸'.repeat(this.lives)+'ğŸ–¤'.repeat(3-this.lives)}
  nextStage(){if(this.stage<2){this.stage++;this.lives=3;this.setupStage()}else if(!this.won){this.won=true;this.stop();setTimeout(()=>gameWin(2),400)}}
  loop(){if(!this.running)return;this.update();this.draw();this._raf=requestAnimationFrame(()=>this.loop())}
  update(){if(!this.started)return;const b=this.ball;b.x+=b.dx;b.y+=b.dy;if(b.x-this.br<0||b.x+this.br>this.W)b.dx*=-1;if(b.y-this.br<0)b.dy=Math.abs(b.dy);if(b.y>this.H+10){this.lives--;this.updateInfo();if(this.lives<=0){this.lives=3;this.setupStage()}else this.resetBall();return}const py=this.H-30;if(b.dy>0&&b.y+this.br>=py&&b.y+this.br<=py+this.ph+4&&b.x>=this.px&&b.x<=this.px+this.pw){b.dy=-Math.abs(b.dy);const hit=(b.x-(this.px+this.pw/2))/(this.pw/2);b.dx=hit*this.spd*1.5;b.y=py-this.br}for(let i=this.bricks.length-1;i>=0;i--){const br=this.bricks[i];if(b.x+this.br>br.x&&b.x-this.br<br.x+br.w&&b.y+this.br>br.y&&b.y-this.br<br.y+br.h){this.bricks.splice(i,1);b.dy*=-1;if(!this.bricks.length)this.nextStage();break}}}
  draw(){const c=this.ctx;c.clearRect(0,0,this.W,this.H);this.bricks.forEach(b=>{c.fillStyle=b.color;c.beginPath();c.roundRect(b.x,b.y,b.w,b.h,4);c.fill()});c.fillStyle='#fff';c.beginPath();c.roundRect(this.px,this.H-30,this.pw,this.ph,6);c.fill();c.fillStyle=this.started?'#ffd700':'rgba(255,215,0,.4)';c.beginPath();c.arc(this.ball.x,this.ball.y,this.br,0,Math.PI*2);c.fill();if(!this.started){c.fillStyle='rgba(255,255,255,.6)';c.font='600 14px Quicksand';c.textAlign='center';c.fillText('í„°ì¹˜í•´ì„œ ì‹œì‘!',this.W/2,this.H*.55)}}
}

/* MEMORY - 18 pairs */
class Memory{
  constructor(){this.emojis=['ğŸŒ¸','ğŸŒº','ğŸŒ¹','ğŸŒ·','ğŸ’®','ğŸµï¸','ğŸ’—','ğŸ’–','ğŸ’','ğŸ©·','ğŸ’•','â¤ï¸','ğŸ€','â­','ğŸ’','ğŸ”®','ğŸ§','ğŸ°'];this.pairs=18;this.cards=[...this.emojis,...this.emojis];this.shuffle();this.flipped=[];this.matched=0;this.locked=false;this.el=document.getElementById('mgrid');this.render()}
  stop(){}
  shuffle(){for(let i=this.cards.length-1;i>0;i--){const j=Math.random()*(i+1)|0;[this.cards[i],this.cards[j]]=[this.cards[j],this.cards[i]]}}
  render(){this.el.innerHTML='';this.cards.forEach((e,i)=>{const d=document.createElement('div');d.className='mc';d.innerHTML='<div class="mc-in"><div class="mc-f">âœ¦</div><div class="mc-b">'+e+'</div></div>';d.addEventListener('click',()=>this.flip(i,d));this.el.appendChild(d)})}
  flip(i,el){if(this.locked||el.classList.contains('flip')||el.classList.contains('matched'))return;el.classList.add('flip');this.flipped.push({i,el,e:this.cards[i]});if(this.flipped.length===2){this.locked=true;const[a,b]=this.flipped;if(a.e===b.e){a.el.classList.add('matched');b.el.classList.add('matched');this.matched++;document.getElementById('sc3').textContent=this.matched+'/18';this.flipped=[];this.locked=false;if(this.matched>=this.pairs)setTimeout(()=>gameWin(3),500)}else setTimeout(()=>{a.el.classList.remove('flip');b.el.classList.remove('flip');this.flipped=[];this.locked=false},600)}}
}
updateHub();
</script>
</body></html>
